# StreamVault Auth Server Environment Variables
# Copy this to .env and fill in your values

GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
REDIRECT_URI=https://your-app-name.onrender.com/auth/callback
PORT=3001

# Optional browser CORS allowlist. Leave empty to allow all origins.
# Format: comma/newline/semicolon separated values.
# Example: CORS_ALLOWED_ORIGINS=https://app.example.com,https://staging.example.com
CORS_ALLOWED_ORIGINS=

# Required to protect /health/runtime endpoint (browser password prompt)
RUNTIME_METRICS_USERNAME=runtime
RUNTIME_METRICS_PASSWORD=change-this-to-a-strong-password

# Runtime endpoint hardening (anti-bruteforce, generous defaults)
RUNTIME_RATE_WINDOW_MS=600000
RUNTIME_RATE_MAX_REQUESTS=300
RUNTIME_AUTH_FAIL_WINDOW_MS=1800000
RUNTIME_AUTH_MAX_FAILS=20
RUNTIME_AUTH_LOCK_MS=3600000

# TMDB credential pool (supports up to 5 keys/tokens)
# You can use numbered vars:
# TMDB_ACCESS_TOKEN_1=...
# TMDB_ACCESS_TOKEN_2=...
# OR one list var:
# TMDB_ACCESS_TOKENS=token1,token2,token3
#
# API keys are also supported:
# TMDB_API_KEY_1=...
# TMDB_API_KEYS=key1,key2
TMDB_ACCESS_TOKEN_1=
TMDB_ACCESS_TOKEN_2=
TMDB_ACCESS_TOKEN_3=
TMDB_ACCESS_TOKEN_4=
TMDB_ACCESS_TOKEN_5=

# TMDB proxy logging
# 1 = enabled, 0 = disabled
TMDB_PROXY_LOGS=1
# Extra request detail logs (path/query-key info)
TMDB_PROXY_DEBUG=0
# WatchTogether/Social live runtime logs (high-volume, disable for production)
WT_LIVE_LOGS=0
SOCIAL_DEBUG_LOGS=0
# Optional per-key in-flight cap (0 = unlimited)
TMDB_MAX_INFLIGHT_PER_KEY=0

# AI chat proxy (signed + rate-limited)
# Your internal/provider wrapper endpoint. This server proxies to it.
# For OpenAI-compatible backends, you can pass the base /v1 URL.
# The server auto-resolves /v1 -> /v1/chat/completions when AI_OPENAI_COMPAT_MODE=1.
# Example: AI_WRAPPER_URL=https://your-ai-wrapper.example.com/v1
AI_WRAPPER_URL=
# Optional auth injected server-side when calling AI_WRAPPER_URL.
# If header is Authorization and token does not start with "Bearer ", Bearer is auto-prefixed.
AI_WRAPPER_AUTH_HEADER=Authorization
AI_WRAPPER_AUTH_TOKEN=
# OpenAI compatibility mode + default model routing
AI_OPENAI_COMPAT_MODE=1
AI_DEFAULT_MODEL=llama-3.1-8b-instant
# Branded assistant identity and allowed self-description
AI_BRAND_NAME=StreamVault AI
AI_APP_DESCRIPTION=the in-app assistant for StreamVault that helps users discover movies and TV shows
# Shared secret used to validate x-ai-signature from clients.
AI_CLIENT_SIGNATURE_SECRET=change-this-ai-signature-secret
# Upstream timeout in ms
AI_WRAPPER_TIMEOUT_MS=30000

# Free-tier quota (per fingerprint hash)
AI_FREE_MAX_CHATS=10
AI_FREE_WINDOW_DAYS=7

# Signed request freshness/replay protection
AI_SIGNATURE_MAX_AGE_MS=300000
AI_NONCE_TTL_MS=300000

# Optional browser origin allowlist (comma/newline/semicolon separated).
# Leave empty to skip browser-origin checks.
# Example: AI_ALLOWED_ORIGINS=https://app.example.com,https://staging.example.com
AI_ALLOWED_ORIGINS=

# Admin API key for upgrade-request review endpoints:
#   GET  /api/admin/ai/upgrade-requests
#   POST /api/admin/ai/upgrade-requests/:id/approve
#   POST /api/admin/ai/upgrade-requests/:id/reject
#   GET  /api/admin/ai/entitlements
AI_ADMIN_API_KEY=change-this-admin-ai-key

# Default policy applied when an upgrade request is approved.
AI_UPGRADE_APPROVED_MAX_CHATS=20
AI_UPGRADE_APPROVED_WINDOW_DAYS=3
AI_UPGRADE_APPROVED_DURATION_DAYS=30

# If Turso is disconnected:
# 0 = block AI requests (recommended for strict limits)
# 1 = use in-memory fallback (non-persistent, dev-only)
AI_ALLOW_UNPERSISTED_LIMITS=0
